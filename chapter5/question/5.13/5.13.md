# 研究課題5.13
## 課題内容
Unixの一部バージョンは、データブロックのみ、iノードのみ、両方の３つのバージョンのO_SYNCをサポートする。
片方の書き込みだけを保証したい理由として、どのようなものが考えられるだろうか、説明しなさい。
これら３種類を制御するフラグの名前はなにか。

## そもそもO_SYNCとはなにか？
openシステムコールのオプションの一つである。
Manページには以下のように書いてある。

```
 O_SYNC ファイルに対する書き込み操作は、同期 I/O のファイル完全性完了の要件に基づいて行われる (これに対し O_DSYNC では同期 I/O のデータ完全性完了が提供される)。

 write(2) (や同様のコール) が返るまでに、 書き込まれたデータと関連するファイルメタデータが裏で利用されているハードウェアに転送される (つまり、write(2) の後に fsync(2)
 を呼び出したのと同じようになる)。 下記の「注意」も参照のこと。
```

要はwriteが完了するまでに、ハードウェアにきちんと反映されるということ。
writeのあとにfsyncを行ったのと同じ動作になる。
上の説明のファイルメタデータはinodeのことである。

## 片方の書き込みだけを保証したい理由は何があるか？
- データベースやジャーナル
O_DSYNCに関してはinodeが変化しないとき（つまり上書き時）にはinode更新を保証する必要も最悪ないため、処理が早い。
無駄なiノード同期を省いて性能を稼ぐことができる。

- リアルタイムアプリ
中身だけあ残っていれば良くて、mtimeとかはどうでもいいケース（使い捨てのデータなど）

## これら３種類を制御するフラグの名前はなにか？
### O_SYNC
inodeとデータブロックの両方の書き込みを保証する。write後にfsyncが行われたものになる。

### O_DSYNC
データブロックのみの書き込みを保証する。

### inodeのみ
過去はそういった仕組みがあったが、混乱がひどかったため、現在はそのような仕様はない。
inodeのみのフラグ名は存在しなかった。



