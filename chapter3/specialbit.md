# modeの特殊ビットに関して    
st_modeメンバのファイルタイプとパーミッション情報の他の３bitには以下の情報が含まれている。    
    
## suidビット    
 ３つの特殊ビットに関しての先頭は、suidビットと呼ばれる。    
ここのビットは、プログラム実行時に「実行ユーザーの権限」ではなく「ファイル所有者の権限」で動作させるための仕組み。     
 例えばこのビットは通常ユーザーはどのようにして自分のパスワードを書き換えるのかということに関係している。    
    
passwdを書き換えるのは、通常passwdコマンドを使うことで書き換えることができる。    
    
### passwdファイル    
パスワードを書き換えるのは /etc/passwdファイルを書き換えることと同義であるが、ここに書くパーミッションは持っていない。    
書き込みパーミッションを持っているのはrootだけ。    
    
これに関する対処はプログラムに書き込み権限を与えるというのが対処方になる。    
/usr/bin/passwd　をls -lしたものを見てみよう。    
    
```    
$ ls -l /usr/bin/passwd     
    
-rwsr-xr-x 1 root root 59976 Feb  6  2024 /usr/bin/passwd    
```    
    
※ 厳密には、現在のLinuxではユーザーのパスワード情報は `/etc/shadow` に記録されており、このファイルの所有者も root です。    
    
    
4文字目の実行ユーザーの実行のところ。本来がxのところがsと表示されている。    
これは、プログラムのオーナーが実行しているかのようにプログラムを実行せよとカーネルに指示している。    
**suid(set-user-id)がセットされている場合、カーネルが実行ユーザーIDにプログラムのオーナーのIDをセットするという仕様になっている。**    
    
    
    
root というユーザーは/etc/passwd のオーナーなので、rootをユーザーとして実行されるプログラムはこのファイルを書き換え可能になる。    
    
この仕様は他のものでもいろいろつかわれる。    
    
## sgidビット    
３つの特殊ビットの２番目は sgid（set-group-ID）ビット。    
このビットは、実行ファイルに対しては suid のグループ版として、実効グループID（effective GID）を変更する。    
    
ディレクトリに対しては別の意味を持ち、**新しく作られたファイルやサブディレクトリが、そのディレクトリのグループIDを継承する**ようになる。    
    
## stickyビット    
　３つの特殊ビットに関しての最後の１個はstickyビットになる。    
ファイルに設定されている場合は、ハードディスク中のスワップ用に確保した領域にスワップアウトしろという認識をさせるためのビットだったが、今はそういう使い方をしなくなった。    
ディレクトリに設定される場合は、ディレクトリ内のファイルを削除できるユーザーをオーナー限定にする機能を持っている。    
    
例 '/tmp'ディレクトリはstickyビットが立っている。    
    
    
    
    
    
