# 研究課題4.9
## 課題内容
**隠しサブツリー** mountコマンドでファイルシステムを接続するとき、
マウントポイントは元のファイルシステムに含まれるディレクトリでなければならない。
例えば /dev/hda のファイルシステムを/home2というディレクトリに接続したとする。
この時次の２つの問いに答えなさい。
(a) マウントポイント(この場合は/home2)が存在しない場合はどうなるか。
(b) マウントポイントが存在し、ファイルやサブディレクトリを含んでいる場合はどうなるか？

## 実際に試す
内容的にファイルシステムが壊れる危険があると思われるので、仮想のイメージファイルで再現。

### 存在しないマウントポイントに接続しようとするとどうなるか？

```
$ dd if=/dev/zero of=disk.img bs=1M
 count=100
100+0 レコード入力
100+0 レコード出力
104857600 bytes (105 MB, 100 MiB) copied, 0.0551977 s, 1.9 GB/s
$ 

$ mkfs.ext4 disk.img
mke2fs 1.46.5 (30-Dec-2021)
Discarding device blocks: done                            
Creating filesystem with 25600 4k blocks and 25600 inodes

Allocating group tables: done                            
Writing inode tables: done                            
Creating journal (1024 blocks): done
Writing superblocks and filesystem accounting information: done

$ sudo mount -o loop disk.img 
4.09.md   demodir/  disk.img 

$ sudo mount -o loop disk.img demodir23
[sudo] taichi84 のパスワード: 
mount: demodir23: マウントポイントが存在しません.


```

存在しないマウントポイントに接続しようとすると、mountコマンドはエラーを返す。

### マウントポイントが存在し、ファイルやディレクトリを含んでいる場合

```

$ sudo mount -o loop disk.img demodir
$ ls
4.09.md  demodir  disk.img

$ cd demodir
$ ls
lost+found

```

lost+foundというファイルだけが作成され、あとは全ての元あったファイルが見えなくなる。
これは隠しファイルとかにされているわけではなく、
単純にマウントポイント以下のファイル群が（消えたわけではない）新しいファイルシステムのルートが接続オーバーレイされている形になる。

その証拠に、umountすれば、また元のファイルが見えるようになるはずだ。

```
$ sudo umount demodir
$ ls demodir
a  c  test.sh  y

```

元のファイルが見えるようになった。


