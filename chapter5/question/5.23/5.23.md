# 研究課題
## 課題内容
writeがかかってきて作業を邪魔されるのがいやだと思うユーザーは、mesgコマンドを使うことができる。
mesgのマニュアルページを読み、実際に動かして、どのような仕組み７日を調べなさい。そして、独自バージョンのmesgを書きなさい。
## mesgをまずは使ってみる。
実際に使ってみて何が起こるのか？

```
$ ls -l /dev/pts/2 
crw------- 1 taichi84 taichi84 136, 2 10月 14 13:08 /dev/pts/2                                 
$ mesg y           
$ ls -l /dev/pts/2 
crw--w--w- 1 taichi84 taichi84 136, 2 10月 14 13:08 /dev/pts/2                        
```

どうやらmesgはコマンドのユーザーの端末の書き込み権限を管理しているだけのようだ。
groupとotherの書き込み権限を消しているだけだ。


## 実際のコード

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/stat.h>
#include <unistd.h>

int main(int ac, char *av[]) {

  char *ttypath = ttyname(STDIN_FILENO);
  char ans;

  if (ac != 2) {
    fprintf(stderr, "引数の数が違います\n");
    exit(1);
  }

  ans = av[1][0];

  if (ans == 'y') {
    if (chmod(ttypath, 0622) == -1) {
      perror("chmod failed");
      return 1;
    }

  } else {
    if (chmod(ttypath, 0600) == -1) {
      perror("chmod failed");
      return 1;
    }
  }

  return 0;
}
```

## 実行結果

```
$ ./mesg1 n
$ ls -l /dev/pts/0
crw------- 1 taichi84 taichi84 136, 0 10月 14 13:29 /dev/pts/0
$ ./mesg1 y
$ ls -l /dev/pts/0
crw--w--w- 1 taichi84 taichi84 136, 0 10月 14 13:30 /dev/pts/0

```
